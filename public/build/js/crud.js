obtenerEntidades(),document.addEventListener("DOMContentLoaded",(function(){modal(),"evaluacion"===entidadSingular&&(eventCambiarTutor(),eventEliminarEvaluaciones())}));let entidades=[],maestros=[],tutorias=[],filtradas=[];function eventEliminarEvaluaciones(){document.querySelector("#btn-eliminar").addEventListener("click",(()=>{mostrarEntidad(editar=!1,cambiar=!1,eliminar=!0)}))}function eventCambiarTutor(){document.querySelector("#btn-cambiar").addEventListener("click",(()=>{mostrarEntidad(editar=!1,cambiar=!0,eliminar=!1)}))}const inputBuscar=document.querySelector("#buscar");function buscarSolictud(e){const t=e.target.value;""!==t?(filtradas="evaluacion"===entidadSingular?entidades.filter((e=>(e.nombreAlumno+" "+e.apellidosAlumno).toLowerCase().startsWith(t.toLowerCase()))):entidades.filter((e=>(e.nombre+" "+e.apellidos).toLowerCase().startsWith(t.toLowerCase()))),0===filtradas.length&&(filtradas.length=1)):filtradas=[],mostrarEntidades()}async function obtenerEntidades(){try{const e=`/api/${entidadNombre}`,t=await fetch(e),o=await t.json();entidades=o.entidad,maestros=o.maestros,tutorias=o.tutorias,mostrarEntidades()}catch(e){console.log(e)}}function modal(){document.querySelector("#btn-crear").addEventListener("click",(function(){mostrarEntidad()}))}function mostrarEntidad(e=!1,t=!1,o=!1,r={}){const n=document.createElement("DIV");n.classList.add("absolute","top-0","left-0","w-full","h-full","bg-gray-600/50","flex","justify-center","items-center","z-30","fixed");const a={semestres:["Octavo Semestre","Septimo Semestre","Sexto Semestre","Quinto Semestre","Cuarto Semestre","Tercer Semestre","Segundo Semestre","Primer Semestre"],carreras:["Ingenieria en Sistemas Computacionales","Ingenieria en Inovacion Agricola","Ingenieria en Mecatronica","Ingenieria en Industrias Alimentarias","Ingenieria en Administracion","Ingenieria en Geociencias"],grupos:["A","B","C","D","E","F"]},l=a.semestres.map((e=>`\n        <option value="${e}" ${r.semestre===e?"selected":""}>${e}</option>\n    `)).join(""),i=a.carreras.map((e=>`\n        <option value="${e}" ${r.carrera===e?"selected":""}>${e}</option>\n    `)).join(""),s=a.grupos.map((e=>`\n        <option value="${e}" ${r.grupo===e?"selected":""}>${e}</option>\n    `)).join("");if("maestro"===entidadSingular&&(n.innerHTML=`\n        <div id="formulario" class="w-xl bg-white opacity-100 p-5 rounded-lg scale-in-ver-top m-4 md:m-0">\n            <h1 id="referencia" class="text-blue-700 font-bold text-xl">Agregar maestro</h1>\n            <div class="flex gap-5">\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"nombre" class="">Nombre</label>\n                    <input id="nombre" type="text" value="${r.nombre?r.nombre:""}"name="nombre" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500 " placeholder="${r.nombre?"Ingresa el nuevo nombre":"Ingresa el nombre del maestro"}">\n                </div>\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"apellidos" class="">Apellidos</label>\n                    <input type="text" value="${r.apellidos?r.apellidos:""}"name="apellidos" id="apellidos" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500 " placeholder="${r.apellidos?"Ingresa los nuevos apellidos":"Ingresa los apellidos"}">\n                </div>\n            </div>\n            <div class="flex gap-5">\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"numero" class="">Numero</label>\n                    <input type="number" value="${r.numero?r.numero:""}" name="numero" id="numero" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500 " placeholder="${r.numero?"Ingresa el nuevo numero":"Ingresa el numero del maestro"}">\n                </div>\n            </div>\n            <div class="flex mt-3 w-full gap-5">\n                <button id="cerrar" class="w-full px-3 py-2 bg-gray-200 hover:bg-gray-300 transition-all rounded-lg cursor-pointer font-medium">Cerrar</button>\n                <button id="submit" class="w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 transition-all rounded-lg cursor-pointer font-medium text-white">${e?"Editar":"Guardar"}</button>\n            </div>\n        </div>\n    `),"alumno"===entidadSingular&&(n.innerHTML=`\n        <div id="formulario" class="w-xl bg-white opacity-100 p-5 rounded-lg scale-in-ver-top m-4 md:m-0">\n            <h1 id="referencia" class="text-blue-700 font-bold text-xl">Agregar alumno</h1>\n            <div class="flex gap-5">\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"nombre">Nombre</label>\n                    <input id="nombre" type="text" value="${r.nombre?r.nombre:""}" name="nombre" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500 " placeholder="${r.nombre?"Ingresa el nuevo nombre":"Ingresa el nombre del maestro"}">\n                </div>\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"apellidos">Apellidos</label>\n                    <input id="apellidos" type="text" value="${r.apellidos?r.apellidos:""}" name="apellidos" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500 " placeholder="${r.apellidos?"Ingresa los nuevos apellidos":"Ingresa los apellidos"}">\n                </div>\n            </div>\n            <div class="flex gap-5">\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"numeroControl">Numero de control</label>\n                    <input id="numeroControl"type="number" value="${r.numeroControl?r.numeroControl:""}" name="numeroControl" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500 " placeholder="${r.numeroControl?"Ingresa el numero de control":"Ingresa el nuevo numero de control"}">\n                </div>\n            </div>\n            <div class="flex gap-5">\n                <div class="flex flex-col gap-2 mt-2 w-full">\n                    <label for"password">Contraseña</label>\n                    <input id="password" type="text" value="${r.password?r.password:""}" name="password" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500" placeholder="${r.password?"Ingresa la contraseña":"Ingresa la nueva contraseña"}">\n                </div>\n            </div>\n            <div class="flex flex-col gap-2 mt-2 w-full">\n                <label for"semestre">Semestre</label>\n                <select id="semestre" name="semestre" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                    <option selected disabled value="">Selecciona el semestre</option>\n                    ${l}\n                </select>\n            </div>\n            <div class="flex flex-col gap-2 mt-2 w-full">\n                <label for"carrera">Carrera</label>\n                <select id="carrera" name="carrera" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                    <option selected disabled value="">Selecciona la carrera</option>\n                    ${i}\n                </select>\n            </div>\n\n            <div class="flex flex-col gap-2 mt-2 w-full">\n                <label for"grupo">Grupo</label>\n                <select id="grupo" name="grupo" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                    <option selected disabled value="">Selecciona el grupo</option>\n                    ${s}\n                </select>\n            </div>\n\n            <div class="flex mt-3 w-full gap-5">\n                <button id="cerrar" class="w-full px-3 py-2 bg-gray-200 hover:bg-gray-300 transition-all rounded-lg cursor-pointer font-medium">Cerrar</button>\n                <button id="submit" class="w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 transition-all rounded-lg cursor-pointer font-medium text-white">${e?"Editar":"Guardar"}</button>\n            </div>\n        </div>\n    `),"evaluacion"===entidadSingular){const a=maestros.map((e=>`\n            <option value="${e.id}|${e.nombre}|${e.apellidos}" ${r.idMaestro===e.id?"selected":""}>\n                ${e.nombre} ${e.apellidos}\n            </option>\n        `)).join(""),d=tutorias.map((e=>`\n            <option value="${e.tutorias}">\n                ${e.tutorias}\n            </option>\n        `)).join("");n.innerHTML=t?`\n            <div id="formulario" class="w-xl bg-white opacity-100 p-5 rounded-lg scale-in-ver-top m-4 md:m-0">\n                <h1 id="referencia" class="text-blue-700 font-bold text-xl">Cambiar Tutor</h1>\n                <p class="text-gray-600 mt-2">Asigna un nuevo tutor de un grupo</p>\n                    <fieldset class = "mt-3">\n                    <legend class="font-medium text-gray-800">Grupo</legend>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <select id="tutorias" name="tutorias" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona el grupo de tutorias</option>\n                            ${d}\n                        </select>\n                    </div>\n                    </fieldset>\n                    <fieldset class = "mt-3">\n                    <legend class="font-medium text-gray-800">Nuevo Tutor</legend>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <select id="maestro" name="idMaestro" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona el maestro</option>\n                            ${a}\n                        </select>\n                    </div>\n                    </fieldset>\n                    <div class="flex mt-3 w-full gap-5">\n                        <button id="cerrar" class="w-full px-3 py-2 bg-gray-200 hover:bg-gray-300 transition-all rounded-lg cursor-pointer font-medium">Cerrar</button>\n                        <button id="submit" class="w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 transition-all rounded-lg cursor-pointer font-medium text-white">${e?"Editar":"Guardar"}</button>\n                    </div>\n            </div>\n            `:o?`\n            <div id="formulario" class="w-xl bg-white opacity-100 p-5 rounded-lg scale-in-ver-top m-4 md:m-0">\n                <h1 id="referencia" class="text-blue-700 font-bold text-xl">Eliminar Grupo</h1>\n                <p class="text-gray-600 mt-2">Si eliminas un grupo no podras revertir las evaluaciones</p>\n                    <fieldset class = "mt-3">\n                    <legend class="font-medium text-gray-800">Grupo</legend>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <select id="tutorias" name="tutorias" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona el grupo de tutorias</option>\n                            ${d}\n                        </select>\n                    </div>\n                    <div class="flex mt-3 w-full gap-5">\n                        <button id="cerrar" class="w-full px-3 py-2 bg-gray-200 hover:bg-gray-300 transition-all rounded-lg cursor-pointer font-medium">Cerrar</button>\n                        <button id="submit" class="w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 transition-all rounded-lg cursor-pointer font-medium text-white">${e?"Editar":"Guardar"}</button>\n                    </div>\n            </div>\n            `:`\n            <div id="formulario" class="w-xl bg-white opacity-100 p-5 rounded-lg scale-in-ver-top m-4 md:m-0">\n                <h1 id="referencia" class="text-blue-700 font-bold text-xl">${t?"Cambiar":o?"Eliminar":"Asignar"} tutor</h1>\n                <p class="text-gray-600 mt-2">Asigna un tutor a todos los alumnos que coincidan con los criterios.</p>\n                    <fieldset class="mt-3">\n                    <legend class="font-medium text-gray-800">Información del grupo</legend>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <label for"semestre">Semestre</label>\n                        <select id="semestre" name="semestre" class="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona el semestre</option>\n                            ${l}\n                        </select>\n                    </div>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <label for"carrera">Carrera</label>\n                        <select id="carrera" name="carrera" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona la carrera</option>\n                            ${i}\n                        </select>\n                    </div>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <label for"grupo">Grupo</label>\n                        <select id="grupo" name="grupo" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona el grupo</option>\n                            ${s}\n                        </select>\n                    </div>\n                    </fieldset>\n                    <fieldset class = "mt-3">\n                    <legend class="font-medium text-gray-800">Tutor</legend>\n                    <div class="flex flex-col gap-2 mt-2 w-full">\n                        <label for"grupo">Maestro</label>\n                        <select id="maestro" name="idMaestro" class ="w-full border-gray-300 border-1 rounded-xl py-2 px-2 focus:outline-blue-500 focus:bg-blue-50 transition duration-500 ease-in-out outline-blue-500">\n                            <option selected disabled value="">Selecciona el maestro</option>\n                            ${a}\n                        </select>\n                    </div>\n                    </fieldset>\n                    <div class="flex mt-3 w-full gap-5">\n                        <button id="cerrar" class="w-full px-3 py-2 bg-gray-200 hover:bg-gray-300 transition-all rounded-lg cursor-pointer font-medium">Cerrar</button>\n                        <button id="submit" class="w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 transition-all rounded-lg cursor-pointer font-medium text-white">${e?"Editar":"Guardar"}</button>\n                    </div>\n            </div>\n        `}n.addEventListener("click",(function(a){if(a.preventDefault(),"cerrar"===a.target.id){document.querySelector("#formulario").classList.add("scale-in-ver-top-reverse"),setTimeout((()=>{n.remove()}),500)}"submit"===a.target.id&&("maestro"===entidadSingular&&validarMaestro(e,r),"alumno"===entidadSingular&&validarAlumno(e,r),"evaluacion"===entidadSingular&&validarEvaluacion(r,t,o))})),document.querySelector("body").appendChild(n)}function validarMaestro(e,t){const o=document.querySelector("#nombre").value.trim(),r=document.querySelector("#apellidos").value.trim(),n=document.querySelector("#numero").value.trim();if(""===o|""===r||""===n)return void alerta("error","Todos los campos son obligatorios",document.querySelector("#referencia"));if(""===o)return void alerta("error","El nombre es obligatorio",document.querySelector("#referencia"));if(""===r)return void alerta("error","Ingrese los apellidos",document.querySelector("#referencia"));if(""===n)return void alerta("error","El numero es obligatorio",document.querySelector("#referencia"));const a=document.querySelector(".modal"),l={nombre:o,apellidos:r,numero:n};e?(t.nombre=o,t.apellidos=r,t.numero=n,actualizarEntidad(`http://localhost:3000/api/${entidadSingular}/actualizar`,t),a.remove()):(agregar(l,`http://localhost:3000/api/${entidadSingular}`),a.remove())}function validarAlumno(e,t){const o=document.querySelector("#nombre").value.trim(),r=document.querySelector("#apellidos").value.trim(),n=document.querySelector("#numeroControl").value.trim(),a=document.querySelector("#password").value.trim(),l=document.querySelector("#semestre").value.trim(),i=document.querySelector("#carrera").value.trim(),s=document.querySelector("#grupo").value.trim();if(""===o&&""===r&&""===n&&""===a&&""===l&&""===i&&""===s)return void alerta("error","Todos los campos son obligatorios",document.querySelector("#referencia"));if(""===o)return void alerta("error","El nombre es obligatorio",document.querySelector("#referencia"));if(""===r)return void alerta("error","Los apellidos son obligatorios",document.querySelector("#referencia"));if(""===n)return void alerta("error","Ingresa el numero de control",document.querySelector("#referencia"));if(""===a)return void alerta("error","Ingresa el password",document.querySelector("#referencia"));if(""===l)return void alerta("error","Selecciona un semestre",document.querySelector("#referencia"));if(""===i)return void alerta("error","Selecciona una carrera",document.querySelector("#referencia"));if(""===s)return void alerta("error","Selecciona un grupo",document.querySelector("#referencia"));const d=n+"@itstacambaro.edu.mx",u=document.querySelector(".modal"),c={nombre:o,apellidos:r,numeroControl:n,correo:d,password:a,semestre:l,carrera:i,grupo:s};e?(t.nombre=o,t.apellidos=r,t.numeroControl=n,t.correo=d,t.password=a,t.semestre=l,t.carrera=i,t.grupo=s,actualizarEntidad(`http://localhost:3000/api/${entidadSingular}/actualizar`,t),u.remove()):(agregar(c,`http://localhost:3000/api/${entidadSingular}`),u.remove())}function validarEvaluacion(e,t=!1,o=!1){const r=document.querySelector(".modal");if(t){const e=document.querySelector("#maestro").value,[t,o,n]=e.split("|"),a=document.querySelector("#tutorias").value.trim();if(""===a)return void alerta("error","Seleccione un grupo de tutorias",document.querySelector("#referencia"));if(""===t)return void alerta("error","Seleccione un maestro",document.querySelector("#referencia"));return confirmarCambiarTutor({tutorias:a,maestro:t,nombreMaestro:o,apellidosMaestro:n}),void r.remove()}if(o){const t=document.querySelector("#tutorias").value.trim();if(""===t)return void alerta("error","Seleccione un grupo de tutorias",document.querySelector("#referencia"));return confirmarEliminarEvaluaciones({tutorias:t},e),void r.remove()}const n=document.querySelector("#semestre").value.trim(),a=document.querySelector("#carrera").value.trim(),l=document.querySelector("#grupo").value.trim(),i=document.querySelector("#maestro").value,[s,d,u]=i.split("|");if(""===n)return void alerta("error","Selecciona un semestre",document.querySelector("#referencia"));if(""===a)return void alerta("error","Selecciona una carrera",document.querySelector("#referencia"));if(""===l)return void alerta("error","Selecciona un grupo",document.querySelector("#referencia"));if(""===s)return void alerta("error","Seleccione un maestro",document.querySelector("#referencia"));let c=a.match(/[A-Z]/g),m=c?c.join(""):"",p="";switch(n){case"Octavo Semestre":p="8";break;case"Septimo Semestre":p="7";break;case"Sexto Semestre":p="6";break;case"Quinto Semestre":p="5";break;case"Cuarto Semestre":p="4";break;case"Tercer Semestre":p="3";break;case"Segundo Semestre":p="2";break;case"Primer Semestre":p="1"}let f="";f=f.concat(m,"-",p,"-",l);agregar({semestre:n,carrera:a,grupo:l,tutorias:{tutorias:f},maestro:s,nombreMaestro:d,apellidosMaestro:u},`http://localhost:3000/api/${entidadSingular}`),r.remove()}function mostrarEntidades(){limpiarEntidades();const e=filtradas.length?filtradas:entidades;0!==e.length&&e.forEach((e=>{const t=document.createElement("TR");if(t.classList.add("border-b","border-gray-200"),"maestros"===entidadNombre){const o=document.createElement("TD");o.classList.add("p-3"),o.textContent=e.nombre+" "+e.apellidos;const r=document.createElement("TD");r.classList.add("p-3"),r.textContent=e.numero,t.appendChild(o),t.appendChild(r)}if("alumnos"===entidadNombre){const o=document.createElement("TD");o.classList.add("p-3"),o.textContent=e.nombre+" "+e.apellidos;const r=document.createElement("TD");r.classList.add("p-3"),r.textContent=e.numeroControl;const n=document.createElement("TD");n.classList.add("p-3","md:table-cell","hidden"),n.textContent=e.correo;const a=document.createElement("TD");a.classList.add("p-3","md:table-cell","hidden"),a.textContent=e.semestre,t.appendChild(o),t.appendChild(r),t.appendChild(n),t.appendChild(a)}if("evaluaciones"===entidadNombre){const o=document.createElement("TD");o.classList.add("p-3"),o.textContent=e.nombreAlumno+" "+e.apellidosAlumno;const r=document.createElement("TD");r.classList.add("p-3"),r.textContent=e.tutorias;const n=document.createElement("TD");n.classList.add("p-3"),n.textContent=e.nombreMaestro+" "+e.apellidosMaestro;const a=document.createElement("TD"),l=document.createElement("P");a.classList.add("p-3"),a.appendChild(l),0===Number.parseInt(e.estado)?(l.textContent="Sin realizar",l.classList.add("bg-red-50","px-3","py-1","inline","rounded-md","border-1","border-red-200","text-red-600","font-medium")):(l.textContent="Realizada",l.classList.add("bg-green-50","px-3","py-1","inline","rounded-md","border-1","border-green-200","text-green-600","font-medium")),t.appendChild(o),t.appendChild(r),t.appendChild(n),t.appendChild(a)}const o=document.createElement("TD");if(o.classList.add("md:flex-row","flex-col","flex","gap-3","items-center","p-3"),"evaluaciones"!==entidadNombre){const t=document.createElement("BUTTON");t.classList.add("cursor-pointer"),t.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#2835ff">\n            <path d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z" />\n        </svg>\n        ',t.addEventListener("click",(function(){console.log(e),mostrarEntidad(editar=!0,cambiar=!1,eliminar=!1,{...e})}));const r=document.createElement("BUTTON");r.classList.add("cursor-pointer"),r.innerHTML='\n        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#8B1A10">\n            <path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z" />\n        </svg>\n        ',r.ondblclick=function(){confirmarEliminarEntidad({...e})},o.appendChild(t),o.appendChild(r)}t.appendChild(o),document.querySelector("#tbody").appendChild(t)}))}async function agregar(e,t){const o=new FormData;for(const t in e)o.append(t,e[t]);try{const r=await fetch(t,{method:"POST",body:o}),n=await r.json();if("exito"===n.tipo)new Notyf({duration:3e3,position:{x:"right",y:"top"}}).success(n.mensaje),"evaluacion"===entidadSingular?(console.log(e.tutorias),console.log(tutorias),tutorias=[...tutorias,e.tutorias],console.log(tutorias),n.evaluaciones.forEach((t=>{t.tutorias=e.tutorias.tutorias,entidades=[...entidades,t]})),mostrarEntidades()):(e.id=String(n.id),entidades=[...entidades,e],mostrarEntidades());if("error"===n.tipo)new Notyf({duration:3e3,position:{x:"right",y:"top"}}).error(n.mensaje)}catch(e){console.log(e)}}async function actualizarEntidad(e,t){console.log(t);const o=new FormData;for(const e in t)o.append(e,t[e]);try{const r=await fetch(e,{method:"POST",body:o}),n=await r.json();if("exito"===n.tipo){new Notyf({duration:3e3,position:{x:"right",y:"top"}}).success(n.mensaje);let e=[];for(const o in t)e.push(o);entidades=entidades.map((e=>(e.id===t.id&&(e=t),e))),mostrarEntidades()}}catch(e){console.log(e)}}async function eliminarEntidad(e){const t=new FormData;for(const o in e)t.append(o,e[o]);try{const o=`http://localhost:3000/api/${entidadSingular}/eliminar`,r=await fetch(o,{method:"POST",body:t}),n=await r.json();if("exito"===n.tipo)new Notyf({duration:3e3,position:{x:"right",y:"top"}}).success(n.mensaje),entidades=entidades.filter((t=>t.id!==e.id)),mostrarEntidades()}catch(e){console.log(e)}}async function eliminarEvaluaciones(e){const t=new FormData;for(const o in e)t.append(o,e[o]);try{const o=`http://localhost:3000/api/${entidadSingular}/eliminarEvaluaciones`,r=await fetch(o,{method:"POST",body:t}),n=await r.json();if("success"===n.tipo)new Notyf({duration:3e3,position:{x:"right",y:"top"}}).success(n.mensaje),entidades=entidades.filter((t=>t.tutorias!==e.tutorias)),mostrarEntidades();if("error"===n.tipo)new Notyf({duration:3e3,position:{x:"right",y:"top"}}).error(n.mensaje)}catch(e){console.log(e)}}async function actualizarTutor(e){const t=new FormData;for(const o in e)t.append(o,e[o]);try{const o=`http://localhost:3000/api/${entidadSingular}/actualizarTutor`,r=await fetch(o,{method:"POST",body:t}),n=await r.json();if("exito"===n.tipo)new Notyf({duration:3e3,position:{x:"right",y:"top"}}).success(n.mensaje),entidades.forEach((t=>{t.tutorias===e.tutorias&&(t.idMaestro=e.idMaestro,t.nombreMaestro=e.nombreMaestro,t.apellidosMaestro=e.apellidosMaestro)})),mostrarEntidades();if("error"===n.tipo)new Notyf({duration:4e3,position:{x:"right",y:"top"}}).error(n.mensaje)}catch(e){console.log(e)}}function confirmarEliminarEntidad(e){Swal.fire({title:`¿Eliminar ${entidadSingular}?`,showCancelButton:!0,confirmButtonText:"Eliminar",text:`Estas seguro de eliminar al ${entidadSingular} ${e.nombre+" "+e.apellidos}`,cancelButtonText:"Cancelar",cancelButtonColor:"#99a3a4",confirmButtonColor:"#000fff"}).then((t=>{t.isConfirmed&&eliminarEntidad(e)}))}function confirmarCambiarTutor(e){Swal.fire({title:"¿Asignar un nuevo tutor?",showCancelButton:!0,confirmButtonText:"Cambiar tutor",text:`¿Deseas asignar el tutor ${e.nombreMaestro+" "+e.apellidosMaestro} al grupo ${e.tutorias}?`,cancelButtonText:"Cancelar",cancelButtonColor:"#99a3a4",confirmButtonColor:"#000fff"}).then((t=>{t.isConfirmed&&actualizarTutor(e)}))}function confirmarEliminarEvaluaciones(e){Swal.fire({title:"¿Eliminar grupo?",showCancelButton:!0,confirmButtonText:"Eliminar",text:`Estas seguro de eliminar el grupo ${e.tutorias}, no podras revertir las evaluaciones`,cancelButtonText:"Cancelar",cancelButtonColor:"#99a3a4",confirmButtonColor:"#000fff"}).then((t=>{t.isConfirmed&&eliminarEvaluaciones(e)}))}function limpiarEntidades(){const e=document.querySelector("#tbody");for(;e.firstChild;)e.removeChild(e.firstChild)}function alerta(e,t,o){const r=document.querySelector(".alerta");r&&r.remove();const n=document.createElement("DIV");n.textContent=t,n.classList.add("px-1","py-2","bg-red-500","text-white","font-bold","rounded-lg","my-2","text-center","alerta"),o.parentElement.insertBefore(n,o.nextElementSibling),setTimeout((()=>{n.remove()}),3500)}inputBuscar.addEventListener("input",buscarSolictud);