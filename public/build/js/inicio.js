obtenerEntidades();let entidades=[],filtradas=[],tutorias=[],tutoriasFiltradas=[];const inputBuscar=document.querySelector("#buscar");inputBuscar.addEventListener("input",buscarSolictud);const btnFiltroEstado=document.querySelector("#btn-filtro-estado"),dropMenu=document.querySelector("#drop-menu-estado");function filtrarEstado(){document.querySelectorAll('[name="estado"]').forEach((t=>{t.addEventListener("input",(t=>{console.log(t.target.value);const e=t.target.value;"radio-completadas"===e&&(filtradas=entidades.filter((t=>"1"===t.estado)),mostrarEntidades()),"radio-no-completadas"===e&&(filtradas=entidades.filter((t=>"0"===t.estado)),mostrarEntidades()),"radio-todas"===e&&(filtradas=entidades,mostrarEntidades())}))}))}btnFiltroEstado.addEventListener("click",(()=>{const t=document.querySelector("#drop-menu-estado");document.querySelector("#drop-menu-grupo").classList.add("hidden"),abrirMenuFiltros(t),filtrarEstado()}));const inputBuscarGrupo=document.querySelector("#buscar-grupo");function buscarGrupo(t){const e=t.target.value.toLowerCase();tutoriasFiltradas=""!==e?tutorias.filter((t=>t.tutorias.toLowerCase().includes(e))):[...tutorias],mostrarTutorias(),filtrarGrupo()}inputBuscarGrupo.addEventListener("input",buscarGrupo);const btnFiltroGrupo=document.querySelector("#btn-filtro-grupo"),dropMenuGrupo=document.querySelector("#drop-menu-grupo");function filtrarGrupo(){document.querySelectorAll('[name="grupo"]').forEach((t=>{t.addEventListener("input",(t=>{const e=t.target.value;console.log(e),filtradas=entidades.filter((t=>t.tutorias===e)),mostrarEntidades()}))}))}function buscarSolictud(t){const e=t.target.value;filtradas=""!==e?"evaluacion"===entidadSingular?entidades.filter((t=>(t.nombreAlumno+" "+t.apellidosAlumno).toLowerCase().startsWith(e.toLowerCase()))):entidades.filter((t=>(t.nombre+" "+t.apellidos).toLowerCase().startsWith(e.toLowerCase()))):[],mostrarEntidades()}async function obtenerEntidades(){try{const t=`/api/${entidadNombre}`,e=await fetch(t),r=await e.json();entidades=r.entidad,tutorias=r.tutorias,mostrarEntidades(),mostrarTutorias()}catch(t){console.log(t)}}function mostrarTutorias(){const t=tutoriasFiltradas.length>0?tutoriasFiltradas:tutorias,e=document.querySelector("#listado");for(e.innerHTML="";e.firstChild;)e.removeChild(e.firstChild);t.forEach((t=>{const r=document.createElement("DIV");r.classList.add("flex","gap-4","p-1"),r.id="grupo";const o=document.createElement("INPUT");o.type="radio",o.name="grupo",o.id=t.tutorias,o.value=t.tutorias,o.classList.add("accent-blue-700","cursor-pointer");const a=document.createElement("LABEL");a.name="grupo",a.textContent=t.tutorias,a.classList.add("cursor-pointer"),a.setAttribute("for",t.tutorias);const d=document.createElement("HR");d.classList.add("border-gray-300","w-full","my-2"),r.appendChild(o),r.appendChild(a),e.appendChild(r),e.appendChild(d)}))}function mostrarEntidades(){limpiarEntidades();const t=filtradas.length?filtradas:entidades;if(0===t.length){const t=document.querySelector("#body"),e=document.createElement("DIV");return e.textContent="No se encontraron evaluaciones",e.classList.add("text-center","text-gray-400","p-4"),void t.appendChild(e)}t.forEach((t=>{const e=document.createElement("TR");e.classList.add("border-b","border-gray-200");const r=document.createElement("TD");r.classList.add("p-3"),r.textContent=t.nombreAlumno+" "+t.apellidosAlumno;const o=document.createElement("TD");o.classList.add("p-3","hidden","md:table-cell"),o.textContent=t.tutorias;const a=document.createElement("TD");a.classList.add("p-3","hidden","md:table-cell"),a.textContent=t.nombreMaestro+" "+t.apellidosMaestro;const d=document.createElement("TD"),n=document.createElement("P");d.classList.add("p-3"),d.appendChild(n),0===Number.parseInt(t.estado)?(n.textContent="Sin realizar",n.classList.add("bg-red-50","px-3","py-1","inline","rounded-md","border-1","border-red-200","text-red-600","font-medium")):(n.textContent="Realizada",n.classList.add("bg-green-50","px-3","py-1","inline","rounded-md","border-1","border-green-200","text-green-600","font-medium")),e.appendChild(r),e.appendChild(o),e.appendChild(a),e.appendChild(d),document.querySelector("#tbody").appendChild(e)}))}function limpiarEntidades(){const t=document.querySelector("#tbody");for(;t.firstChild;)t.removeChild(t.firstChild)}function abrirMenuFiltros(t){t.classList.contains("hidden")?(t.classList.remove("hidden"),t.classList.remove("scale-in-ver-top-reverse"),t.classList.add("scale-in-ver-top")):(t.classList.remove("scale-in-ver-top"),t.classList.add("scale-in-ver-top-reverse"),setTimeout((()=>{t.classList.add("hidden")}),300))}btnFiltroGrupo.addEventListener("click",(()=>{const t=document.querySelector("#drop-menu-grupo");document.querySelector("#drop-menu-estado").classList.add("hidden"),abrirMenuFiltros(t),filtrarGrupo()}));